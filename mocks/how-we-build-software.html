<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>How we build the software — Product Factory</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f1419;
      --surface: #1a2332;
      --surface2: #243044;
      --text: #e6edf3;
      --text-muted: #8b949e;
      --accent: #58a6ff;
      --accent-dim: #388bfd33;
      --success: #3fb950;
      --border: #30363d;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'DM Sans', system-ui, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; font-size: 14px; }
    .header {
      background: var(--surface); border-bottom: 1px solid var(--border);
      padding: 12px 24px; display: flex; align-items: center; justify-content: space-between;
    }
    .logo { font-weight: 700; color: var(--accent); }
    .back { color: var(--text-muted); text-decoration: none; font-size: 13px; }
    .back:hover { color: var(--accent); }
    main { max-width: 820px; margin: 0 auto; padding: 32px 24px; }
    h1 { font-size: 1.5rem; margin: 0 0 8px 0; }
    .subtitle { color: var(--text-muted); margin-bottom: 28px; font-size: 13px; }
    .trigger { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 14px 18px; margin-bottom: 24px; font-size: 13px; }
    .trigger strong { color: var(--accent); }

    .steps { counter-reset: step; }
    .step {
      display: flex; gap: 20px; margin-bottom: 0; padding: 20px 0;
      border-left: 2px solid var(--border); margin-left: 13px; padding-left: 28px;
      position: relative;
    }
    .step:last-child { border-left-color: transparent; }
    .step::before {
      counter-increment: step;
      content: counter(step);
      position: absolute; left: -14px; top: 22px;
      width: 24px; height: 24px; border-radius: 50%;
      background: var(--surface2); border: 2px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: 700; color: var(--text-muted);
    }
    .step.done::before { background: var(--success); border-color: var(--success); color: var(--bg); }
    .step-body { flex: 1; min-width: 0; }
    .step-title { font-weight: 600; font-size: 1rem; margin-bottom: 6px; }
    .step-desc { font-size: 13px; color: var(--text-muted); line-height: 1.5; margin-bottom: 10px; }
    .step-detail {
      background: var(--surface); border: 1px solid var(--border); border-radius: 6px;
      padding: 10px 12px; font-size: 12px; font-family: ui-monospace, monospace; color: var(--text-muted);
    }
    .step-detail code { color: var(--accent); }
    .who { font-size: 11px; color: var(--text-muted); margin-top: 8px; }
    .output { margin-top: 16px; padding: 12px 16px; background: var(--accent-dim); border-radius: 6px; font-size: 13px; }
    .output strong { color: var(--accent); }
    .footer { text-align: center; padding: 24px; color: var(--text-muted); font-size: 12px; }
  </style>
</head>
<body>
  <header class="header">
    <span class="logo">Product Factory</span>
    <a href="product-factory-dashboard.html" class="back" id="backLink">← Pipeline</a>
  </header>

  <main>
    <h1>How we build the software</h1>
    <p class="subtitle">Double-click on the Build stage: from compliance sign-off to code in repo and CI/CD. Same context bundle everywhere.</p>

    <div class="trigger">
      <strong>Trigger:</strong> Compliance sign-off (stage 6) done. Capability has approved spec (doc + version) and approved architecture. Context bundle available: capability ID, spec path, arch path, tickets, Slack.
    </div>

    <div class="trigger" style="margin-bottom: 20px; border-left: 3px solid var(--accent);">
      <strong>Build readiness</strong> — Required: approved spec + version, approved architecture, capability YAML, compliance passed. Recommended: codebase context (configured at <a href="product-config-mock.html" style="color: var(--accent);">product level</a>), acceptance criteria. “Do we have enough context to build?” is checked before the pipeline runs.
    </div>

    <div class="steps">
      <div class="step done">
        <div class="step-body">
          <div class="step-title">Load context</div>
          <div class="step-desc">Build pipeline (or engineer) loads the context bundle: approved spec and architecture from Git (paths + versions from ticket or config). No build without this.</div>
          <div class="step-detail">Context: PROJ-101 · spec <code>product-specs/PROJ-101.md</code> @ a1b2c3d · arch <code>docs/architecture/PROJ-101.md</code> @ c4d5e6f</div>
        </div>
      </div>

      <div class="step done">
        <div class="step-body">
          <div class="step-title">Spec → tech capabilities</div>
          <div class="step-desc">GenAI turns the approved product spec into a technology capability description (YAML: entities, APIs, screens, skills, COGS). Architecture constrains stack and patterns.</div>
          <div class="step-detail">Output: capability YAML (e.g. <code>capabilities/PROJ-101.yaml</code>) — machine-readable target for codegen and tickets.</div>
          <div class="who">Pillar: 02-product-to-technology</div>
        </div>
      </div>

      <div class="step done">
        <div class="step-body">
          <div class="step-title">GenAI pipeline runs</div>
          <div class="step-desc">Using capability YAML + architecture, GenAI produces (or scaffolds) UI, APIs, backend, tests, and optionally agent/skill stubs. Output goes to the configured app repo. Pipeline run COGS recorded.</div>
          <div class="step-detail">Repo: app repo (configured) · Branch: <code>proj-101/lead-scoring-api</code> · COGS for run → dashboard</div>
          <div class="who">Pillars: 08-genai-pipeline, 06-agents-and-skills</div>
        </div>
      </div>

      <div class="step done">
        <div class="step-body">
          <div class="step-title">Code in repo + PR</div>
          <div class="step-desc">Code committed to branch; PR opened and linked to the capability ticket. PR description or bot comment carries context bundle (capability ID, spec/arch links, Slack) for reviewers.</div>
          <div class="step-detail">PR #42 → linked to Issue #101 · Bot comment: “Capability PROJ-101 · [Spec] · [Arch] · [Slack #proj-101]”</div>
        </div>
      </div>

      <div class="step done">
        <div class="step-body">
          <div class="step-title">Human review</div>
          <div class="step-desc">Engineers (and/or PM) review the PR. Mandatory approval before merge. Discussion in PR or in capability Slack channel. Rework on same branch.</div>
          <div class="who">Engineering owns review; GenAI produced first cut; same context bundle for both.</div>
        </div>
      </div>

      <div class="step">
        <div class="step-body">
          <div class="step-title">Merge → CI/CD</div>
          <div class="step-desc">On merge: CI/CD runs (build, test, deploy to staging). Tickets updated (“In staging”). Pipeline stage moves to CI/CD to stage (8), then UAT (9) when ready.</div>
          <div class="step-detail">Merge → GitHub Actions / CI → staging deploy · Ticket #101 status: In staging</div>
          <div class="who">Pillar: 05-release-and-cicd</div>
        </div>
      </div>
    </div>

    <div class="output">
      <strong>Output:</strong> Code in app repo, PR(s) linked to capability ticket, CI/CD green, deploy to staging. Next: UAT (stage 9) → Release (stage 10).
    </div>
    <p class="subtitle" style="margin-top:20px;">Test cases are generated from spec/acceptance criteria; test results and quality metrics (pass/fail, coverage) are <strong>published</strong> in the leadership dashboard so everything is visible online.</p>
  </main>

  <footer class="footer">
    Product Factory mock · How we build the software (double-click on Build)
  </footer>
  <script>
    (function() {
      var p = new URLSearchParams(window.location.search).get('product');
      var back = document.getElementById('backLink');
      if (back && p) back.href = 'product-factory-dashboard.html?product=' + encodeURIComponent(p);
    })();
  </script>
</body>
</html>
